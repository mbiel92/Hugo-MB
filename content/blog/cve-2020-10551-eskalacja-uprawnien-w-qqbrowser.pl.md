+++
lang="pl-PL"
title="CVE-2020-10551 - eskalacja uprawnień w QQBrowser"
date="2020-04-07"
author="Maciej Miszczyk"
image="/blog/Seqred_CVE.jpg"
tags=['cve','research', 'vulnerability']
+++

#### QQBrowser to przeglądarka internetowa wyprodukowana przez firmę Tencent. Jest to jedna z najpopularniejszych przeglądarek w Chinach. Podczas testów zidentyfikowaliśmy podatność umożliwiającą nieuprzywilejowanemu lokalnemu atakującemu na wykonanie kodu z uprawnieniami użytkownika ZARZĄDZANIE NT\\SYSTEM.

CVEID: **CVE-2020-10551**\
Podatny produkt i jego wersja: **QQBrowser (wszystkie wersje poniżej
10.5.3870.400)**\
Typ podatności: **CWE-284: Niewłaściwa kontrola dostępu**

### Podsumowanie

Wszystkie wersje QQBrowser poniżej 10.5.3870.400 niepoprawnie
konfigurują ACL dla pliku TsService.exe. Złośliwy atakujący posiadający
możliwość wykonania kodu na podatnym komputerze może nadpisać ten plik i
uzyskać dostęp do konta ZARZĄDZANIE NT\\SYSTEM (najwyższy poziom
uprawnień w systemie Windows).

### Opis

QQBrowser konfiguruje usługę systemu Windows w której zmienna ImagePath
wskazuje na plik TsService.exe znajdujący się w jej katalogu
instalacyjnym (domyślnie: C:\\Program Files
(x86)\\Tencent\\QQBrowser\\TsService.exe). Uprawnienia dostępu do pliku
pozwalają na pisanie do niego przez członków grupy ZARZĄDZANIE
NT\\Użytkownicy Uwierzytelnienie, do której domyślnie należy każdy
użytkownik. Atakujący może wykorzystać podatność umieszczając swój
program w lokalizacji pliku TsService.exe, sprawiając że zostanie on
wykonany z uprawnieniami ZARZĄDZANIE NT\\SYSTEM.

### Reprodukcja

Usuń plik TsService.exe i zastąp go innym programem. Zrestartuj system.

### Rozwiązanie

Zaktualizuj QQBrowser do najnowszej wersji.
