+++
lang="pl-PL"
title="CVE-2019-14514 - zdalne wykonanie kodu w MEmu"
date="2020-02-04"
author="Maciej Miszczyk"
image="/blog/Seqred_CVE.jpg"
+++

MEmu to emulator Androida dla system Windows. Podczas testów,
znaleźliśmy otwarty port TCP który można było wykorzystać do uzyskania
zdalnego wykonania kodu z uprawnieniami użytkownika root.

**CVEID:** CVE-2019-14514\
**Podatny produkt i jego wersja:** Microvirt MEmu (wszystkie wersje
poniżej 7.0.2)\
**Typ podatności:** CWE-78: Wstrzyknięcie poleceń systemu operacyjnego

### Podsumowanie

Wszystkie wersje MEmu poniżej 7.0.2 posiadają podatny program słuchający
na porcie 21509. Atakujący jest w stanie uzyskać wykonanie kodu w
emulowanym systemie Android wysyłając spreparowane polecenia zawierające
znaki specjalny oddzielające komendy w powłokach uniksowych.

### Opis

Program/ system/ bin/ systemd (niezwiązany z programem Freedesktop
systemd wykorzystywanym jako init w popularnych dystrybucjach linuksa)
jest uruchamiany z uprawnieniami użytkownika root i przyjmuje polecenia
na porcie 21509. Jeżeli przesłane polecenia zaczyna się od ciągu znaków
installer:uninstall, dane kontrolowane przez atakującego zostaną
umieszczone w poleceniu powłoki i przesłane do /system/bin/sh bez żadnej
weryfikacji. Oznacza to, że atakujący jest w stanie przesłać znaki
specjalne takie jak ;, && lub \|\| żeby przesłać własne polecenia
powłoki które zostaną wykonane w emulowanym systemi z uprawnieniami
użytkownika root.

### Reprodukcja

echo "installer:uninstall;\[polecenie_do_wykonania\]" \| nc
\[ip_emulatora\] 21509

### Rozwiązanie

Aktualizacja MEmu do wersji 7.0.2 lub nowszej