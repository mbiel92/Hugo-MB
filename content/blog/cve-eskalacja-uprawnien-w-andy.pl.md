+++
lang="pl-PL"
title="CVE-2019-14326 - eskalacja uprawnień w Andy"
date="2020-03-17"
author="Maciej Miszczyk"
image="/blog/Seqred_CVE.jpg"
tags=['cve']
+++

## Andy to emulator Android dla Windows i Mac.

### Podczas testów, odkryliśmy otwarte lokalne porty TCP pozwalające na eskalację uprawnień od nieuprzywilejowanego użytkownika do użytkownika root.

CVEID: **CVE-2019-14326**\
Podatny produkt i jego wersja: **Andy (wszystkie wersje do 46.11.113
włącznie)**\
Typ podatności: **CWE-284: Niewłaściwa kontrola dostępu**

### Podsumowanie podatności emulatora Andy

Wszystkie wersje emulatora Andy (do wersji 46.11.113 włącznie,
prawdopodobnie także w nowszych wersjach) umożliwiają dostęp do
niezabezpieczonej hasłem konsoli roota przy użyciu protokołów telnet i
ssh.

### Opis

Andy otwiera porty 22 i 23 w emulowanym systemie Android. Są to porty
ssh i telnet, udostępniające niezabezpieczoną hasłem konsolę roota. Błąd
nie może zostać wykorzystany zdalnie ponieważ emulowane urządzenie z
Androidem jest widoczne wyłącznie w sieci VMWare dostępnej tylko dla
komputera hosta i emulowanego systemu Android, jednak może on posłużyć
złośliwym aplikacjom zainstalowanym wewnątrz emulowanego Androida do
uzyskania uprawnień użytkownika root.

### Reprodukcja

echo "\[polecenie_do_wykonania\]" \| busybox telnet localhost 23

### Mitygacja

Zakończyć procesy demonów ssh i telnet.
